<h3 class="text-[1.7rem] font-semibold text-gray-700">Event Management</h3>

<div class="bg-white shadow-md mt-4 p-5">
  <h3 class="font-semibold mb-1 text-[1.2rem]">Add Event Management</h3>


  <div class="my-5 mx-10">
    <div>
      <ul class="flex justify-center items-center">
        <li *ngFor="let tab of tabs; let i = index" (click)="setActiveTab(i)" [class.active]="activeTab === i"
          class="w-full focus-within:z-10">
          <a [ngClass]="{'bg-steelblue-200 dark:text-[rgb(255,255,255)] font-bold': activeTab === i}"
              class="inline-block w-full p-2.5 border-2 text-center
                border-steelblue-200 focus:ring-4 focus:ring-blue-300
                text-steelblue-200" aria-current="page">
            {{ tab }}
          </a>
        </li>
      </ul>

      <form [formGroup]="EventPlannerRegistrationForm"
      class="py-10 px-6 mx-auto border"
          enctype="multipart/form-data">
        <div *ngIf="activeTab === 0">
          <div class="grid grid-cols-6 gap-6" formGroupName="companyInfo">
            <div class="col-span-6 sm:col-span-3">
              <label for="company-name" class="text-sm font-medium text-gray-900 block mb-2">Company
                <span class="text-red-600 text-[1.24rem]">*</span></label>
              <input type="text" formControlName="company" id="company-name" placeholder="ABC Management"
                  class="shadow-sm bg-gray-50 border focus:border-cyan-600 block w-full p-2.5">
              <p class="text-red-600 text-[.75rem] text-left italic"
                  *ngIf="isFieldError('companyInfo', 'company')">Please enter a valid company!
              </p>
            </div>
            <div class="col-span-6 sm:col-span-3">
              <label for="website" class="text-sm font-medium text-gray-900 block mb-2">Website
                <span class="text-[1.24rem]"></span>
              </label>
              <input type="text" formControlName="website" id="website" placeholder="https://website" class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                  focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5">
              <p class="text-red-600 text-[.75rem] text-left italic"
                  *ngIf="isFieldError('companyInfo', 'website')">Please enter a valid website!
              </p>
            </div>
            <div class="col-span-6 sm:col-span-3">
              <label for="email" class="text-sm font-medium text-gray-900 block mb-2">Email
                <span class="text-red-600 text-[1.24rem]">*</span>
              </label>
              <input type="email" formControlName="email" id="email" placeholder="youremail@gmail.com"
                  class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                  focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5">
              <p class="text-red-600 text-[.75rem] text-left italic"
                  *ngIf="isFieldError('companyInfo', 'email')">Please enter a valid email!
              </p>
            </div>
            <div class="col-span-6 sm:col-span-3">
              <label for="mobile" class="text-sm font-medium text-gray-900 block mb-2">Mobile
                <span class="text-red-600 text-[1.24rem]">*</span>
              </label>
              <input type="text" formControlName="mobile" id="mobile" placeholder="812345678"
                  class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5">
              <p class="text-red-600 text-[.75rem] text-left italic"
                *ngIf="isFieldError('companyInfo', 'mobile')">Please enter a valid mobile!
              </p>
            </div>
            <div class="col-span-6 sm:col-span-3">
              <label for="startYear" class="text-sm font-medium text-gray-900 block mb-2">Started Year
                <span class="text-red-600 text-[1.24rem]">*</span>
              </label>
              <input type="number" formControlName="startYear" id="startYear" placeholder="2018" class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5">
              <p class="text-red-600 text-[.75rem] text-left italic"
                  *ngIf="isFieldError('companyInfo', 'startYear')">Please enter a valid start year!
              </p>
            </div>
            <div class="col-span-6 sm:col-span-3">
              <label for="maxEvents" class="text-sm font-medium text-gray-900 block mb-2">Maximum Events(Daily basis)
                <span class="text-red-600 text-[1.24rem]">*</span>
              </label>
              <input type="number" formControlName="maxEvents" id="maxEvents" placeholder="eg.1" class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5">
              <p class="text-red-600 text-[.75rem] text-left italic"
                  *ngIf="isFieldError('companyInfo', 'maxEvents')">Please enter a valid maximum events count!
              </p>
            </div>
            <!--Planning Fee-->
            <div class="col-span-6">
              <fieldset class="border border-[#787879] p-4">
                <legend>Planning Fee <span class="text-red-600 text-[1.24rem]">*</span></legend>
                <div class="grid grid-cols-12 gap-6">
                  <div class="col-span-6">
                    <label for="minPrice" class="text-sm font-medium text-gray-900 block mb-2">Minimum Price
                    </label>
                    <input type="text" formControlName="minPrice" id="minPrice" placeholder="Rs.10000" class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                            focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5">
                    <p class="text-red-600 text-[.75rem] text-left italic"
                        *ngIf="isFieldError('companyInfo', 'minPrice')">Please enter a valid minimum price!
                    </p>
                  </div>
                  <div class="col-span-6">
                    <label for="maxPrice" class="text-sm font-medium text-gray-900 block mb-2">Maximum Price
                    </label>
                    <input type="text" formControlName="maxPrice" id="maxPrice" placeholder="Rs.400000" class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg
                            focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5">
                    <p class="text-red-600 text-[.75rem] text-left italic"
                        *ngIf="isFieldError('companyInfo', 'maxPrice')">Please enter a valid maximum price!
                    </p>
                  </div>
                </div>
              </fieldset>
            </div>

            <!--Description-->
            <div class="col-span-6">
              <label for="description" class="text-sm font-medium text-gray-900 block mb-2">Description
                <span class="text-red-600 text-[1.24rem]">*</span>
              </label>
              <quill-editor  formControlName="description" [modules]="editorConfig" class="h-36"></quill-editor>
              <p class="text-red-600 text-[.75rem] text-left italic"
                  *ngIf="isFieldError('companyInfo', 'description')">Please enter a valid description!
              </p>
            </div>
          </div>
        </div>

        <!--2nd activeTab-->
        <div *ngIf="activeTab === 1">
            <div formGroupName="addressInfo">
              <app-address-form [addressFormGroup]="addressInfoFormGroup"> </app-address-form>
            </div>
        </div>
        <!--2nd activeTab Ends here-->

        <!--3rd activeTab-->
        <div *ngIf="activeTab === 2;" formGroupName="portfolioInfo">
          <div class="grid grid-cols-12 gap-4 bg-white mb-7">
            <div class="col-span-12 relative grid grid-cols-1 md:grid-cols-3 border border-gray-300 bg-gray-100 rounded-lg">
                <div class="rounded-l-lg p-4 bg-gray-200 flex flex-col justify-center items-center border-0 border-r border-gray-300">
                    <label class="cursor-pointer hover:opacity-80 inline-flex items-center shadow-md my-2 px-2 py-2
                        bg-gray-900 text-gray-50 border border-transparent rounded-md font-semibold text-xs uppercase
                          tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900
                          focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150" for="coverPic">
                           Select Image
                        <input id="coverPic" class="text-sm cursor-pointer w-36 hidden" type="file"
                           (change)="onCoverPicSelected($event)">
                    </label>
                    <button (click)="onCoverPicRemove()"
                      class = 'inline-flex items-center shadow-md my-2 px-2 py-2 bg-gray-900 text-gray-50 border border-transparent
                          rounded-md font-semibold text-xs uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none
                         focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150'>
                          remove
                     </button>
                     <p class="text-red-600 text-[.75rem] text-left italic"
                        *ngIf="isFieldError('portfolioInfo', 'coverPic')">Please choose a cover picture!
                      </p>
                </div>

                <div class="md:order-last h-28 md:h-auto flex justify-center items-center
                    border border-dashed border-gray-400 col-span-2 m-2 rounded-lg bg-no-repeat bg-center
                    bg-origin-padding bg-cover">

                    <span class="text-gray-400 opacity-75" *ngIf="!coverImageSrc">
                        <svg class="w-14 h-14"
                            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="0.7" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                            d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                        </svg>
                    </span>
                    <img *ngIf="coverImageSrc" [src]="coverImageSrc" alt="" class="p-3 w-2/3 h-auto" >
                </div>
            </div>
          </div>

          <div class="grid grid-cols-12 gap-4 border border-gray-300 bg-gray-100 rounded-lg p-4">
            <!-- Left Column -->
            <div class="col-span-3">
              <div class="rounded-lg p-4 bg-gray-200 border border-gray-300">
                <h2 class="text-lg font-semibold mb-4">Choose Your Portfolio Images</h2>
                <p class="text-red-600 text-[.75rem] text-left italic" py-3
                    *ngIf="isFieldError('portfolioInfo', 'portfolios')">Please choose 5 images!
                </p>
                <label for="image-upload" class="cursor-pointer inline-flex items-center px-4 py-2 bg-gray-900
                            text-gray-50 rounded-md shadow-md hover:bg-gray-700 transition duration-300">
                  <i class="fa-solid fa-upload mr-2"></i>
                  Select Image
                </label>
                <!-- Hidden input for file upload -->
                <input id="image-upload" type="file" (change)="onFileSelected($event)" accept="image/*" multiple
                  class="hidden">
              </div>
            </div>

            <!-- Right Column -->
            <div class="col-span-9">
              <h2 class="text-lg font-semibold mb-4">Uploaded Images</h2>
              <div class="grid grid-cols-2 gap-4">
                <!-- Display uploaded images -->
                <div *ngFor="let image of uploadedImages; let i = index" class="relative">
                  <img [src]="image.url" [alt]="'Uploaded Image ' + (i + 1)" class="w-full h-auto rounded-lg">
                  <button type="button" class="absolute top-2 right-2 bg-[#ffffffbe] text-gray-700 rounded-full
                      p-1 shadow-md hover:bg-gray-200 transition duration-300" (click)="removeImage(i)">
                      <i class="fa-solid fa-xmark px-1.5 py-0.5 text-[1.1rem]"></i>
                  </button>
                </div>
                <!-- Repeat for each uploaded image -->
              </div>
            </div>
          </div>
        </div>
        <!--3rd activeTab Ends here-->

        <!--4th active Tab -->
        <div *ngIf="activeTab === 3">
          <div class="grid grid-cols-12 gap-6" formGroupName="serviceInfo">

            <!--Services-->
            <div class="col-span-6" formArrayName="services">
              <label for="services" class="text-md font-medium text-gray-900 block mb-2">Services Offered
                <span class="text-red-600">*</span>
              </label>
              <p class="text-red-600 text-[.75rem] text-left italic" py-3
                  *ngIf="isFieldError('serviceInfo', 'services')">Please choose ateast one service!
              </p>
              <div class="bg-white rounded-lg shadow">
                <div class="p-3">
                  <div class="relative">
                    <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                      <i class="fa-solid fa-magnifying-glass text-gray-400"></i>
                    </div>
                    <input type="text" [(ngModel)]="searchTerm"  [ngModelOptions]="{standalone: true}"
                      class="bg-gray-50 border border-gray-300
                      text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500
                      block w-full ps-10 p-2.5 dark:border-gray-500 dark:placeholder-gray-400
                      dark:text-black dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Search Service">
                  </div>
                </div>
                <ul class="h-48 px-3 pb-3 overflow-y-auto text-sm text-black dark:text-gray-200">
                  <li *ngFor="let service of serviceControls | searchFilter:searchTerm:'name'; let i = index">
                    <div
                        class="flex items-center p-2 rounded hover:bg-gray-100 dark:hover:bg-cyan-600 hover:text-white">
                      <input id="checkbox-{{i}}" type="checkbox" [value]="service" (change)="onCheckboxChange($event,i)"
                        [checked]="service.selected"
                        class="w-4 h-4 text-gray-600
                        bg-gray-100 border-gray-300 rounded focus:ring-gray-500 dark:focus:ring-gray-600
                        dark:ring-offset-gray-700  focus:ring-1 dark:bg-gray-100 dark:border-gray-500">
                      <label for="checkbox-{{i}}"
                        class="w-full ms-2 text-sm font-medium text-gray-900 rounded">{{service.name}}</label>
                    </div>
                  </li>
                </ul>
              </div>
            </div>

            <!-- planned cities-->
            <div class="col-span-6">
              <h2 class="ext-md font-medium text-gray-900 block mb-2">Previously Planned Cities
                <span class="text-red-600">*</span>
              </h2>
              <p class="text-red-600 text-[.75rem] text-left italic" py-3
                  *ngIf="isFieldError('serviceInfo', 'plannedCities')">
                  Please enter ateast one value (Must not contain duplicate values)!
              </p>

              <div formArrayName="plannedCities">
                <div *ngFor="let cityControl of plannedCities.controls; let i = index" class="flex items-center space-x-4 mb-2">
                  <!-- Input for city name -->
                  <input type="text" [formControlName]="i"
                      class="border border-gray-300 rounded-md px-3 py-2 w-full">

                  <!-- Delete button -->
                  <button type="button" class="ml-2 p-2 bg-red-500 text-white rounded hover:bg-red-600"
                    (click)="removeCity(i)">
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                </div>
              </div>

              <!-- Add More button -->
              <button type="button" class="mt-2 p-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                (click)="onAddCity()">
                Add More
              </button>
            </div>

            <div class="col-span-full">
              <div class="my-6 text-center">
                <h2 class="text-xl font-semibold">Confirmation of the Registration of Your Service</h2>
                <hr class="border border-gray-200 w-full my-3">
              </div>

              <h2 class="font-medium text-gray-900 mb-2">Upload Documents
                <span class="text-red-600">*</span>
              </h2>
              <p class="text-red-600 text-[.75rem] text-left italic" py-3
                  *ngIf="isFieldError('serviceInfo', 'document')">Please choose a document!
              </p>
              <div class="flex justify-start">
                <div>
                  <label for="document-upload"
                    class="cursor-pointer inline-flex items-center px-4 py-2 bg-gray-900 text-gray-50 rounded-md shadow-md hover:bg-gray-700 transition duration-300">
                    <i class="fa-solid fa-upload mr-2"></i>Select Document
                  </label>
                   <!-- Hidden input for file upload -->
                    <input id="document-upload" type="file" class="hidden"
                       (change)="onDocumentSelected($event)">
                </div>

                <!-- Display uploaded documents -->
                <div *ngIf="uploadedDocument" class="ml-5">
                  <span class="text-gray-700">{{ uploadedDocument.name }}</span>
                  <button type="button" class="ml-2 p-2 bg-red-500 text-white rounded hover:bg-red-600"
                    (click)="removeDocument()">
                    <i class="fa-solid fa-trash-can"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>

      <div class="flex gap-4 justify-center border-t p-4">
        <button (click)="prevTab()" class="py-2 px-4 border rounded-md border-blue-600 text-blue-600 cursor-pointer
          uppercase text-sm font-bold hover:bg-blue-500 hover:text-white hover:shadow"
          [disabled]="activeTab === 0">Back
        </button>
        <button  *ngIf="activeTab === 3;" (click)="onSubmit()"class="py-2 px-4 border rounded-md border-blue-600
          text-white cursor-pointer uppercase text-sm font-bold bg-blue-600
           hover:shadow">Submit
        </button>
        <button *ngIf="activeTab !== 3" (click)="nextTab()" class="py-2 px-4 border rounded-md border-blue-600
            text-blue-600 cursor-pointer uppercase text-sm font-bold hover:bg-blue-500
            hover:text-white hover:shadow">Next
        </button>

      </div>

    </div>
  </div>
</div>



<app-page-loader *ngIf="isLoading"></app-page-loader>
